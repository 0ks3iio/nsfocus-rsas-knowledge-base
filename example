{'id': 50001, '风险等级': 'high', '漏洞名称': 'ActivePerl PerlIS.dll 远程缓冲区溢出漏洞', '漏洞描述': 'NSFOCUS安全小组发现ActivePerl所带的一个动态链接库(perlIS.dll)在处理超长文件名时存在一个缓冲区溢出漏洞，攻击者可能利用这个漏洞远程执行任意代码。\n\nActivePerl 是ActiveState公司开发的一套二进制perl软件包，可应用于Linux,Solaris,Windows系统下。ActivePerl for windows包含一个名为perlIS.dll的动态链接库文件，它是一个ISAPI扩展，为微软IIS服务器提供了一个高性能的perl接口。\n\nPerlIS可以对用户发送的perl脚本请求进行处理，然而，它没有正确检查用户提交的URL请求的长度。如果用户发送一个超长的URL请求，PerlIS会调用strcpy()将其拷贝到一个堆栈中的缓冲区里，这会触发一个缓冲区溢出。攻击者可以覆盖堆栈中的一些敏感数据，例如返回地址等等，如果精心构造URL请求的内容，攻击者就可以远程执行任意代码。\n\n成功地利用这个漏洞，在IIS 5.0中，攻击者可以获取IWAM_machinename用户的权限. 在IIS 4.0中，攻击者可以获取Local SYSTEM权限。', '解决方法': '临时解决方法: \n\n我们建议用户按照参考如下步骤消除漏洞（以IIS 4.0为例）： \n\n1. 打开Internet 服务管理器 \n2. 右击你的服务器（例如 "* nsfocus"），在菜单中选择"属性"栏 \n3. 选择"主属性" \n4. 选择 WWW 服务 | 编辑 | 主目录 | 配置 \n5. 在扩展名列表中找到对应perlIS.dll的项(通常映射到".pl"或".cgi") \n6. 点击"配置"，然后点击"检查文件是否存在"选项 \n7. 保存设置,然后重启IIS服务。 \n\n厂商补丁： \n\nActiveState公司已经在build 630中修复此安全问题。 \n\n您可以在下列地址下载ActivePerl的最新版本： \n\nhttp://www.activestate.com/Products/ActivePerl/download.plex', '危险分值': '7.5', '危险插件': '否', '发现日期': '2001-12-06', 'CVE编号': 'CVE-2001-0815', 'CNNVD编号': 'CNNVD-200112-035', 'CNCVE编号': 'CNCVE-20010815', 'BUGTRAQ': '3526', 'NSFOCUS': '1975', 'CVSS评分': '7.5', 'CNVD编号': 'CNVD-2009-01975'}
{'id': 50002, '风险等级': 'low', '漏洞名称': 'IKE2 协议 Vendor ID 检测', '漏洞描述': 'IPSEC Internet Key Exchange (IKE) Version 2 Vendor ID 检测', '解决方法': '建议不用修复。', '危险分值': '1.0', '危险插件': '否', '发现日期': '2018-10-24'}
{'id': 40001, '风险等级': 'high', '漏洞名称': '目标主机没有安装MS00-009补丁', '漏洞描述': '此次扫描检测到目标主机尚未安装MS00-009漏洞相应的HotFix，也未安装可以修正该漏洞的Service Pack。\n\n此补丁主要修复Microsoft如下漏洞：\n     Image Source Redirect Vulnerability', '解决方法': '厂商补丁：\n\nMicrosoft\n---------\nMicrosoft已经为此发布了一个安全公告（MS00-009）以及相应补丁:\nPatch Available for "Image Source Redirect" Vulnerability\n链接：https://docs.microsoft.com/en-us/security-updates/securitybulletins/2000/ms00-009', '危险分值': '10.0', '危险插件': '否', '发现日期': '2000-03-01', 'CVE编号': 'CVE-2000-0156,CVE-2000-0061', 'CNNVD编号': 'CNNVD-200002-050,CNNVD-200001-024', 'CNCVE编号': 'CNCVE-20000156,CNCVE-20000061', 'CVSS评分': '10.0'}
{'id': 50003, '风险等级': 'middle', '漏洞名称': 'Microsoft SQL Server 2000 Resolution服务远程拒绝服务攻击漏洞', '漏洞描述': 'Microsoft SQL Server 2000是一款由Microsoft公司开发的商业性质大型数据库系统。\r\n\r\nMicrosoft SQL Server 2000的Resolution服务的在操作keep-alive机制时对请求端缺少正确的检查，远程攻击者可以利用这个漏洞进行拒绝服务攻击。\r\n\r\nMicrosoft SQL Server 2000支持在单个物理主机上伺服多个SQL服务器的实例，每个实例操作需要通过单独的服务，不过多个实例不能全部使用标准SQL服务会话会话端口(TCP 1433)，所以SQL Server Resolution服务操作监听在UDP 1434端口，提供一种使客户端查询适当的网络末端用于特殊的SQL服务实例的途径。\r\n\r\nSQL使用一种keep-alive机制来区别主动和被动的实例，当SQL服务程序在UDP 1434端口接收到单字节为0x0A的UDP包时，会以0x0A应答发送端，但是这种应答只以源IP地址和源端口作为参照信息，攻击者可以伪造发送来自其他SQL服务器的0x0A单字节UDP包给目标SQL服务器，可导致两个SQL服务器进入无限循环的keep-alive包交换中，使的大量系统资源消耗，产生拒绝服务攻击。', '解决方法': '临时解决方法： \r\n\r\n如果您不能立刻安装补丁或者升级，NSFOCUS建议您采取以下措施以降低威胁： \r\n\r\n* 在边界防火墙、网关设备或者SQL Server主机上限制对UDP/1434端口的访问。由于UDP报文的源地址很容易伪造，所以不能简单地限制只允许可信IP访问。', '危险分值': '5.0', '危险插件': '否', '发现日期': '2002-08-12', 'CVE编号': 'CVE-2002-0650', 'CNNVD编号': 'CNNVD-200208-124', 'CNCVE编号': 'CNCVE-20020650', 'BUGTRAQ': '5312', 'NSFOCUS': '3150', 'CVSS评分': '5.0', 'CNVD编号': 'CNVD-2009-03150'}
{'id': 40002, '风险等级': 'middle', '漏洞名称': '目标主机没有安装MS00-027/Q259622补丁', '漏洞描述': '此次扫描检测到目标主机尚未安装MS00-027/Q259622漏洞相应的HotFix，也未安装可以修正该漏洞的Service Pack。\n\n此补丁主要修复Microsoft如下漏洞：\n    Microsoft Windows 恶意环境变量漏洞', '解决方法': '厂商补丁：\n\nMicrosoft\n---------\nMicrosoft已经为此发布了一个安全公告（MS00-027）以及相应补丁:\nPatch Available for "Malformed Environment Variable" Vulnerability\n链接：https://docs.microsoft.com/en-us/security-updates/securitybulletins/2000/ms00-027', '危险分值': '5.0', '危险插件': '否', '发现日期': '2000-04-20', 'CVE编号': 'CVE-2000-0331', 'CNNVD编号': 'CNNVD-200004-052', 'CNCVE编号': 'CNCVE-20000331', 'BUGTRAQ': '1135', 'CVSS评分': '5.0'}
{'id': 40003, '风险等级': 'middle', '漏洞名称': '目标主机没有安装MS00-043/Q267884补丁', '漏洞描述': '此次扫描检测到目标主机尚未安装MS00-043/Q267884漏洞相应的HotFix，也未安装可以修正该漏洞的Service Pack。\n\n此补丁主要修复Microsoft如下漏洞：\n    Microsoft Outlook / Outlook Express GMT 字段缓冲区溢出漏洞', '解决方法': "厂商补丁：\n\nMicrosoft\n---------\nMicrosoft已经为此发布了一个安全公告（MS00-043）以及相应补丁:\nMS00-043：Patch Available for 'Malformed E-mail Header' Vulnerability\n链接：https://docs.microsoft.com/en-us/security-updates/securitybulletins/2000/ms00-043", '危险分值': '5.0', '危险插件': '否', '发现日期': '2000-07-18', 'CVE编号': 'CVE-2000-0567', 'CNNVD编号': 'CNNVD-200007-048', 'CNCVE编号': 'CNCVE-20000567', 'BUGTRAQ': '1481', 'CVSS评分': '5.0'}
{'id': 50004, '风险等级': 'high', '漏洞名称': 'Sun XDR库xdrmem_getbytes()函数整数溢出漏洞', '漏洞描述': 'XDR(外部数据表示)库用来提供一种平台无关的方法来将数据从一个系统进程发送给其他系统进程。\n\nSun Microsystems提供的XDR库中包含的xdrmem_getbytes()函数存在一个整数溢出 ，远程攻击者利用这个漏洞对使用XDR库的应用程序进行攻击，可能以应用程序进程权限在系统上执行任意指令。\n\n问题存在于\'usr/src/lib/libnsl/rpc/xdr_mem.c\'的168行的xdrmem_getbytes()函数：\n\nstatic bool_t \nxdrmem_getbytes(XDR *xdrs, caddr_t addr, int len) \n{ \n        int tmp; \n\n\n        trace2(TR_xdrmem_getbytes, 0, len); \n        if ((tmp = (xdrs->x_handy - len)) < 0) { <--- VULNERABILITY \n                syslog(LOG_WARNING, \n                                ..... \n                                ..... \n                             return (FALSE); \n        } \n        xdrs->x_handy = tmp; \n        (void) memcpy(addr, xdrs->x_private, len); <--- VULNERABILITY \n        xdrs->x_private += len; \n        trace1(TR_xdrmem_getbytes, 1); \n        return (TRUE); \n} \n\n上面代码中"len"是有符号整数，因此如果"len"为负数就会导致缓冲区溢出：\n\nif ((tmp = (xdrs->x_handy - len)) < 0) {  -->这个检查会绕过\n\n但是在memcpy(addr, xdrs->x_private, len);处理时就会导致溢出。攻击者可以构造一个特殊的XDR编码来触发整数溢出，依赖于使用者如何调用xdrmem_getbytes()函数，攻击者可能覆盖一个已经分配的堆区缓冲区，造成堆缓冲区溢出。攻击者可能造成远程服务崩溃或者利用memcpy()实现的一些特点来改变内存数据并执行任意代码。\n\n该漏洞不只是Solaris具有，包括PowerPC/AIX 4.3.3在内的很多系统受此漏洞影响。\n\neEye提供了如下测试数据:\n\nchar evil_rpc[] =\n"\\x23\\x0d\\xf6\\xd2\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x02\\x00\\x01\\x86"\n"\\xa0\\x00\\x00\\x00\\x02\\x00\\x00\\x00\\x05\\x00\\x00\\x00\\x01\\x00\\x00"\n"\\x00\\x20\\x3d\\xd2\\xc9\\x9f\\x00\\x00\\x00\\x09\\x6c\\x6f\\x63\\x61\\x6c"\n"\\x68\\x6f\\x73\\x74\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00"\n"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x01\\x86"\n"\\xa0\\x00\\x00\\x00\\x02\\x00\\x00\\x00\\x04\\xff\\xff\\xff\\xff";', '解决方法': '厂商补丁：\n\nFreeBSD\n-------\nFreeBSD已经为此发布了一个安全公告（FreeBSD-SA-03:05）以及相应补丁:\nFreeBSD-SA-03:05：remote denial-of-service in XDR encoder/decoder\n链接：ftp://ftp.freebsd.org/pub/FreeBSD/CERT/advisories/FreeBSD-SA-03:05.xdr.asc\n\n补丁下载：\n\none of the following:\n\n1) Upgrade your vulnerable system to the FreeBSD 4-STABLE branch; or\nto the RELENG_4_7 (4.7-RELEASE-p8), RELENG_4_6 (4.6-RELEASE-p11), or\nRELENG_5_0 (5.0-RELEASE-p5) security branch dated after the correction\ndate.\n\n2) To patch your present system:\n\nThe following patch has been verified to apply to FreeBSD 4.6, and 4.7\nsystems.\n\na) Download the relevant patch from the location below, and verify the\ndetached PGP signature using your PGP utility.\n\n# fetch ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/patches/SA-03:05/xdr-4.patch\n# fetch ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/patches/SA-03:05/xdr-4.patch.asc\n\nThe following patch has been verified to apply to FreeBSD 5.0 systems.\n\na) Download the relevant patch from the location below, and verify the\ndetached PGP signature using your PGP utility.\n\n# fetch ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/patches/SA-03:05/xdr-5.patch\n# fetch ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/patches/SA-03:05/xdr-5.patch.asc\n\nb) 请以root身份执行下列命令：\n\n# cd /usr/src\n# patch < /path/to/patch\n\nc) Recompile the operating system as described in\n<URL:http://www.freebsd.org/doc/handbook/makeworld.html>.\n\nNote that any statically linked applications that are not part of\nthe base system (i.e. from the Ports Collection or other 3rd-party\nsources) must be recompiled.\n\nAll affected applications must be restarted for them to use the\ncorrected library.  Though not required, rebooting may be the easiest\nway to accomplish this.\n\n2002-12-16  Roland McGrath  \n\n    * sunrpc/xdr_mem.c (xdrmem_inline): Fix argument type.\n    * sunrpc/xdr_rec.c (xdrrec_inline): Likewise.\n    * sunrpc/xdr_stdio.c (xdrstdio_inline): Likewise.\n\n2002-12-13  Paul Eggert  \n\n    * sunrpc/rpc/xdr.h (struct XDR.xdr_ops.x_inline): 2nd arg\n    is now u_int, not int.\n    (struct XDR.x_handy): Now u_int, not int.\n    * sunrpc/xdr_mem.c: Include .\n    (xdrmem_getlong, xdrmem_putlong, xdrmem_getbytes, xdrmem_putbytes,\n    xdrmem_inline, xdrmem_getint32, xdrmem_putint32):\n    x_handy is now unsigned, not signed.\n    Do not decrement x_handy if no change is made.\n    (xdrmem_setpos): Check for int overflow.\n    * sunrpc/xdr_sizeof.c (x_inline): 2nd arg is now unsigned.\n    (xdr_sizeof): Remove cast that is now unnecessary, now that\n    x_handy is unsigned.\n\nIBM\n---\nAIX系统4.3.3, 5.1.0和5.2.0存在此漏洞，IBM已经提供如下官方补丁：\n\nAPAR number for AIX 4.3.3: IY38524\nAPAR number for AIX 5.1.0: IY38434\nAPAR number for AIX 5.2.0: IY39231\n\n请联系供应商获得相关补丁。\n\nMIT\n---\nMIT Kerberos Development Team \n\n利用这个漏洞可使kadmind server进程崩溃，或读取一些敏感信息，如密钥等。相关补丁下载：\n\nhttp://web.mit.edu/kerberos/www/advisories/2003-003-xdr_patch.txt\n\nSun\n---\nSolaris 2.6, 7, 8和9受此漏洞影响，Sun会在如下地址公布Sun Alert公告并提供补丁信息：\n\nhttp://sunsolve.Sun.COM/pub-cgi/retrieve.pl?doc=fsalert/51884', '危险分值': '7.5', '危险插件': '否', '发现日期': '2003-03-25', 'CVE编号': 'CVE-2003-0028', 'CNNVD编号': 'CNNVD-200303-077', 'CNCVE编号': 'CNCVE-20030028', 'BUGTRAQ': '7123', 'NSFOCUS': '4569', 'CVSS评分': '7.5', 'CNVD编号': 'CNVD-2009-04569'}
{'id': 70001, '风险等级': 'middle', '漏洞名称': 'Samba NSS主机查询Winbind多个远程缓冲区溢出漏洞', '漏洞描述': '本次扫描根据版本进行，可能存在误报。\n\nSamba是一套实现SMB（Server Messages Block）协议、跨平台进行文件共享和打印共享服务的程序。\n\nSun Solaris的nss_winbind.so.1库实现上存在漏洞，远程攻击者可能利用此漏洞在服务器上执行任意指令。\n\n如果Sun Solaris系统运行Samba的winbindd守护程序且配置为使用nss_winbind.so.1库进行gethostbyname()和getipnodebyname()名称解析查询的话，如：\n\n    ## /etc/nsswitch.conf\n    ...\n    ipnodes: files winbind\n    hosts: files winbind\n\n则在将请求发送给winbindd守护程序之前，在把传送给NSS接口的字符串拷贝到静态缓冲区时可能会触发缓冲区溢出，导致执行任意指令。', '解决方法': '临时解决方法：\n\n* 从/etc/nsswitch.conf删除winbind项。\n\n厂商补丁：\n\nSamba\n-----\n目前厂商已经发布了升级补丁以修复这个安全问题，请到厂商的主页下载：\n\nhttp://samba.org/samba/ftp/patches/security/samba-3.0.23d-CVE-2007-0453.patch', '危险分值': '4.6', '危险插件': '否', '发现日期': '2007-02-05', 'CVE编号': 'CVE-2007-0453', 'CNNVD编号': 'CNNVD-200702-075', 'CNCVE编号': 'CNCVE-20070453', 'BUGTRAQ': '22410', 'NSFOCUS': '9925', 'CVSS评分': '4.6', 'CNVD编号': 'CNVD-2009-09925'}